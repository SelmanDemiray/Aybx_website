<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian Citizenship Test Study Guide</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Add this script for local testing to help with CORS issues -->
    <script>
        // Check if we're running locally
        if (window.location.protocol === 'file:') {
            console.log('Running locally - adding CORS warning');
            window.addEventListener('DOMContentLoaded', function() {
                const warning = document.createElement('div');
                warning.style.backgroundColor = '#fff3cd';
                warning.style.color = '#856404';
                warning.style.padding = '15px';
                warning.style.margin = '15px 0';
                warning.style.borderRadius = '5px';
                warning.style.textAlign = 'center';
                warning.innerHTML = `
                    <p><strong>Local Testing Notice:</strong> For full functionality, use a local server or GitHub Pages.</p>
                    <p>Browser security prevents loading local JSON files directly. <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" target="_blank">Learn more about CORS</a></p>
                    <p>Fallback questions will be used instead of loading from JSON files.</p>
                `;
                document.querySelector('main .container').prepend(warning);
            });
        }
    </script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <img src="images/canada-flag.png" alt="Canadian Flag" class="flag-icon">
                <h1>Canadian Citizenship Test Study Guide</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="active" data-page="home">Home</a></li>
                    <li><a href="#" data-page="study">Study</a></li>
                    <li><a href="#" data-page="test">Practice Test</a></li>
                    <li><a href="#" data-page="resources">Resources</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section id="home" class="page active">
                <div class="welcome">
                    <h2>Prepare for Your Canadian Citizenship Test</h2>
                    <p>Welcome to the study guide for "Discover Canada: The Rights and Responsibilities of Citizenship"</p>
                    
                    <div class="stats">
                        <div class="stat-box">
                            <i class="fas fa-book"></i>
                            <span id="total-questions">0</span>
                            <p>Questions</p>
                        </div>
                        <div class="stat-box">
                            <i class="fas fa-layer-group"></i>
                            <span id="total-categories">0</span>
                            <p>Categories</p>
                        </div>
                        <div class="stat-box">
                            <i class="fas fa-star"></i>
                            <span id="user-score">0%</span>
                            <p>Your Score</p>
                        </div>
                    </div>

                    <div class="buttons">
                        <button class="btn primary" data-page="study">Start Studying</button>
                        <button class="btn secondary" data-page="test">Take Practice Test</button>
                    </div>
                </div>
            </section>

            <section id="study" class="page">
                <h2>Study Mode</h2>
                <div class="category-selector">
                    <label for="category">Select Category:</label>
                    <select id="category">
                        <option value="all">All Categories</option>
                    </select>
                </div>
                
                <div class="flashcard-container">
                    <div class="flashcard">
                        <div class="flashcard-inner">
                            <div class="flashcard-front">
                                <p id="question-text">Loading questions...</p>
                            </div>
                            <div class="flashcard-back">
                                <p id="answer-text"></p>
                                <p id="explanation-text"></p>
                                <p id="reference-text" class="reference"></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flashcard-controls">
                        <button id="prev-btn" class="btn secondary"><i class="fas fa-arrow-left"></i> Previous</button>
                        <button id="flip-btn" class="btn primary">Show Answer</button>
                        <button id="next-btn" class="btn secondary">Next <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <div class="progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <p><span id="current-question">0</span>/<span id="total-in-category">0</span></p>
                </div>
            </section>

            <section id="test" class="page">
                <h2>Practice Test</h2>
                <div class="test-options">
                    <div class="test-option">
                        <label for="question-count">Number of Questions:</label>
                        <select id="question-count">
                            <option value="20">20 Questions</option>
                            <option value="30">30 Questions</option>
                            <option value="50">50 Questions</option>
                        </select>
                    </div>
                    <div class="test-option">
                        <label for="test-category">Category:</label>
                        <select id="test-category">
                            <option value="all">All Categories</option>
                            <!-- Other categories will be added dynamically -->
                        </select>
                    </div>
                    <div class="test-option">
                        <label for="test-time">Time Limit:</label>
                        <select id="test-time">
                            <option value="30">30 Minutes</option>
                            <option value="45">45 Minutes</option>
                            <option value="60">60 Minutes</option>
                        </select>
                    </div>
                </div>

                <div class="test-start">
                    <p>The real citizenship test has 20 questions and you need to answer at least 15 correctly to pass.</p>
                    <button id="start-test" class="btn primary">Start Practice Test</button>
                </div>

                <div id="test-area" class="hidden">
                    <div class="test-header">
                        <div class="test-timer">Time Remaining: <span id="timer">30:00</span></div>
                        <div class="test-progress">Question <span id="current-test-question">1</span>/<span id="total-test-questions">20</span></div>
                    </div>
                    
                    <div class="test-question">
                        <p id="test-question-text"></p>
                        <div id="test-options" class="test-options-list"></div>
                    </div>

                    <div class="test-controls">
                        <button id="prev-test-btn" class="btn secondary">Previous</button>
                        <button id="next-test-btn" class="btn secondary">Next</button>
                        <button id="submit-test" class="btn primary">Submit Test</button>
                    </div>
                </div>
            </section>

            <section id="resources" class="page">
                <h2>Additional Resources</h2>
                <div class="resources-list">
                    <div class="resource-card">
                        <h3>Official Study Guide</h3>
                        <p>Download the official "Discover Canada" guide from the Government of Canada website.</p>
                        <a href="https://www.canada.ca/en/immigration-refugees-citizenship/corporate/publications-manuals/discover-canada.html" class="btn secondary" target="_blank">Download PDF</a>
                    </div>
                    <div class="resource-card">
                        <h3>Government of Canada</h3>
                        <p>Visit the official citizenship test information page for the most up-to-date information.</p>
                        <a href="https://www.canada.ca/en/immigration-refugees-citizenship/services/canadian-citizenship/become-canadian-citizen/citizenship-test.html" class="btn secondary" target="_blank">Visit Website</a>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>Â© <span id="current-year"></span> Canadian Citizenship Test Study Guide | This is an unofficial study tool</p>
            <p>Created for educational purposes only. Not affiliated with the Government of Canada.</p>
        </div>
    </footer>

    <!-- Results modal -->
    <div id="results-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Test Results</h2>
            <div id="results-summary"></div>
            <div id="results-details"></div>
            <!-- Modal footer will be added dynamically -->
        </div>
    </div>

    <script src="js/questionLoader.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
